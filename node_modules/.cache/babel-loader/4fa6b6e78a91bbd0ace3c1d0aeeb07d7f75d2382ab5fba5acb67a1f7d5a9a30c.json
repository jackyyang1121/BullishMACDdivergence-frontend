{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import'./App.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const App=()=>{const[stocks,setStocks]=useState([]);const[selectedStockId,setSelectedStockId]=useState('');const[chartUrl,setChartUrl]=useState('');const[error,setError]=useState('');const[progress,setProgress]=useState(0);const[isRunning,setIsRunning]=useState(false);const backendUrl='https://bullishmacddivergence-b4738fb587c2.herokuapp.com/';useEffect(()=>{const fetchStocks=async()=>{try{const response=await axios.get(`${backendUrl}/stocks`);setStocks(response.data.stocks);setError('');}catch(error){console.error('Error fetching stocks:',error.message);setError(`無法獲取背離股票清單：${error.message}`);}};const fetchProgress=async()=>{try{const response=await axios.get(`${backendUrl}/progress`);setProgress(response.data.progress);setIsRunning(response.data.is_running);}catch(error){console.error('Error fetching progress:',error.message);}};fetchStocks();fetchProgress();// 每 2 秒輪詢一次\nconst interval=setInterval(()=>{fetchStocks();fetchProgress();},2000);return()=>clearInterval(interval);// 清理間隔計時器\n},[]);const fetchStockChart=async()=>{if(!selectedStockId){setError('請輸入股票代碼');return;}try{const response=await axios.get(`${backendUrl}/stock/${selectedStockId}`);setChartUrl(`${backendUrl}${response.data.chartUrl}`);setError('');}catch(error){console.error('Error fetching stock chart:',error.message);setError(`無法獲取圖表：${error.message}`);}};return/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px',fontFamily:'Arial'},children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u53F0\\u80A1 MACD \\u80CC\\u96E2\\u5206\\u6790\"}),error&&/*#__PURE__*/_jsx(\"p\",{style:{color:'red'},children:error}),isRunning&&/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u5206\\u6790\\u9032\\u5EA6\\uFF1A\",progress,\"%\"]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u80CC\\u96E2\\u80A1\\u7968\\u6E05\\u55AE\"}),stocks.length>0?/*#__PURE__*/_jsxs(\"table\",{style:{width:'400px',borderCollapse:'collapse',marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{style:{border:'1px solid gray',padding:'5px'},children:\"\\u80A1\\u7968\\u4EE3\\u78BC\"}),/*#__PURE__*/_jsx(\"th\",{style:{border:'1px solid gray',padding:'5px'},children:\"\\u80CC\\u96E2\\u65E5\\u671F\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:stocks.map(stock=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{style:{border:'1px solid gray',padding:'5px'},children:stock.stockId}),/*#__PURE__*/_jsx(\"td\",{style:{border:'1px solid gray',padding:'5px'},children:stock.divergentDates.join(', ')})]},stock.stockId))})]}):/*#__PURE__*/_jsx(\"p\",{children:isRunning?'正在分析股票，請稍候...':'正在載入股票清單...'}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:selectedStockId,onChange:e=>setSelectedStockId(e.target.value),placeholder:\"\\u8F38\\u5165\\u80A1\\u7968\\u4EE3\\u78BC\\uFF08\\u4F8B\\u5982 2330\\uFF09\",style:{width:'300px',height:'40px',marginRight:'10px'}}),/*#__PURE__*/_jsx(\"button\",{onClick:fetchStockChart,style:{height:'40px'},children:\"\\u67E5\\u770B K \\u7DDA\\u5716\"})]}),/*#__PURE__*/_jsx(\"div\",{children:chartUrl?/*#__PURE__*/_jsx(\"img\",{src:chartUrl,alt:\"Stock Chart\",style:{width:'1000px'}}):/*#__PURE__*/_jsx(\"p\",{children:\"\\u8ACB\\u9078\\u64C7\\u80A1\\u7968\\u4EE3\\u78BC\\u4EE5\\u67E5\\u770B K \\u7DDA\\u5716\"})})]});};export default App;//npm start","map":{"version":3,"names":["React","useState","useEffect","axios","jsx","_jsx","jsxs","_jsxs","App","stocks","setStocks","selectedStockId","setSelectedStockId","chartUrl","setChartUrl","error","setError","progress","setProgress","isRunning","setIsRunning","backendUrl","fetchStocks","response","get","data","console","message","fetchProgress","is_running","interval","setInterval","clearInterval","fetchStockChart","style","padding","fontFamily","children","color","marginBottom","length","width","borderCollapse","border","map","stock","stockId","divergentDates","join","type","value","onChange","e","target","placeholder","height","marginRight","onClick","src","alt"],"sources":["/workspaces/BullishMACDdivergence/frontend/src/App.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport './App.css';\n\ninterface Stock {\n  stockId: string;\n  divergentDates: string[];\n}\n\nconst App: React.FC = () => {\n  const [stocks, setStocks] = useState<Stock[]>([]);\n  const [selectedStockId, setSelectedStockId] = useState('');\n  const [chartUrl, setChartUrl] = useState('');\n  const [error, setError] = useState('');\n  const [progress, setProgress] = useState(0);\n  const [isRunning, setIsRunning] = useState(false);\n  const backendUrl = 'https://bullishmacddivergence-b4738fb587c2.herokuapp.com/';\n\n  useEffect(() => {\n    const fetchStocks = async () => {\n      try {\n        const response = await axios.get(`${backendUrl}/stocks`);\n        setStocks(response.data.stocks);\n        setError('');\n      } catch (error: any) {\n        console.error('Error fetching stocks:', error.message);\n        setError(`無法獲取背離股票清單：${error.message}`);\n      }\n    };\n\n    const fetchProgress = async () => {\n      try {\n        const response = await axios.get(`${backendUrl}/progress`);\n        setProgress(response.data.progress);\n        setIsRunning(response.data.is_running);\n      } catch (error: any) {\n        console.error('Error fetching progress:', error.message);\n      }\n    };\n\n    fetchStocks();\n    fetchProgress();\n\n    // 每 2 秒輪詢一次\n    const interval = setInterval(() => {\n      fetchStocks();\n      fetchProgress();\n    }, 2000);\n\n    return () => clearInterval(interval); // 清理間隔計時器\n  }, []);\n\n  const fetchStockChart = async () => {\n    if (!selectedStockId) {\n      setError('請輸入股票代碼');\n      return;\n    }\n    try {\n      const response = await axios.get(`${backendUrl}/stock/${selectedStockId}`);\n      setChartUrl(`${backendUrl}${response.data.chartUrl}`);\n      setError('');\n    } catch (error: any) {\n      console.error('Error fetching stock chart:', error.message);\n      setError(`無法獲取圖表：${error.message}`);\n    }\n  };\n\n  return (\n    <div style={{ padding: '20px', fontFamily: 'Arial' }}>\n      <h1>台股 MACD 背離分析</h1>\n      {error && <p style={{ color: 'red' }}>{error}</p>}\n      {isRunning && <p>分析進度：{progress}%</p>}\n      <div style={{ marginBottom: '20px' }}>\n        <h3>背離股票清單</h3>\n        {stocks.length > 0 ? (\n          <table style={{ width: '400px', borderCollapse: 'collapse', marginBottom: '20px' }}>\n            <thead>\n              <tr>\n                <th style={{ border: '1px solid gray', padding: '5px' }}>股票代碼</th>\n                <th style={{ border: '1px solid gray', padding: '5px' }}>背離日期</th>\n              </tr>\n            </thead>\n            <tbody>\n              {stocks.map((stock) => (\n                <tr key={stock.stockId}>\n                  <td style={{ border: '1px solid gray', padding: '5px' }}>{stock.stockId}</td>\n                  <td style={{ border: '1px solid gray', padding: '5px' }}>\n                    {stock.divergentDates.join(', ')}\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        ) : (\n          <p>{isRunning ? '正在分析股票，請稍候...' : '正在載入股票清單...'}</p>\n        )}\n        <input\n          type=\"text\"\n          value={selectedStockId}\n          onChange={(e) => setSelectedStockId(e.target.value)}\n          placeholder=\"輸入股票代碼（例如 2330）\"\n          style={{ width: '300px', height: '40px', marginRight: '10px' }}\n        />\n        <button onClick={fetchStockChart} style={{ height: '40px' }}>\n          查看 K 線圖\n        </button>\n      </div>\n      <div>\n        {chartUrl ? (\n          <img src={chartUrl} alt=\"Stock Chart\" style={{ width: '1000px' }} />\n        ) : (\n          <p>請選擇股票代碼以查看 K 線圖</p>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default App;\n\n//npm start"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}